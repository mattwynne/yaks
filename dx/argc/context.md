## Current Status: 27/109 Tests Passing

**Working Branch:** `.worktrees/dx-argc` (branch: `dx-argc`)

**What's Working:**
- ✅ argc binary shipped in release zip
- ✅ Installer with symlink architecture
- ✅ argc kept out of user PATH
- ✅ Help auto-generated by argc
- ✅ Basic `add` with validation (11/13 tests) - multi-word names, rejects invalid chars
- ✅ `done` command with --undo, --recursive (6/10 tests) - marks yaks done, checks children
- ✅ Basic `list` command (8/17 tests) - shows yaks, marks done in gray
- ✅ Gitignore check (1/1 test)

**Implementation Approach: Plumbing First, Then Porcelain**

### Phase 1: Plumbing Commands (Core CRUD + State)
**Target: ~60 tests passing**

1. **rm** - Remove yaks (3 tests)
   - Basic directory removal
   - Error on not found
   - Handle removing only yak

2. **Enhance list** - Nested display + filters (9 more tests)
   - Recursive nested display with indentation
   - --format plain (output full paths)
   - --only done/not-done filter
   - Sorting by state and mtime

3. **Enhance done** - Nested yak support (4 more tests)
   - Works with list's nested display
   - Handles parent/child relationships

4. **Add helper functions**
   - find_yak / require_yak (fuzzy matching)
   - get_mtime, get_sort_priority
   - log_command (git ref logging)
   - migrate_done_to_state (backwards compat)

### Phase 2: Porcelain Commands (UX + Integration)
**Target: 109 tests passing**

5. **prune** - Remove all done yaks (3 tests)
   - Uses rm + filtering

6. **context** - Edit yak context (7 tests)
   - Set from stdin
   - --show to display
   - --edit to open in $EDITOR

7. **move** - Rename yaks (6 tests)
   - Renames yak directories
   - Preserves state

8. **Interactive add** - Add multiple yaks (2 tests)
   - No args enters interactive mode
   - Read lines until empty

9. **sync** - Git ref push/pull (11 tests)
   - Push .yaks to refs/notes/yaks
   - Pull and merge from origin
   - Handle conflicts

10. **completions** - Shell integration (9 tests)
    - Output yak names for completion
    - Filter by command context

11. **Git checks** (2 tests)
    - Verify git repo exists
    - Verify git command available

**Current File Size:** 125 lines
**Target:** ~500-600 lines (vs original 923)

**Key Argc Patterns:**
- Use `@alias` for bash reserved words (done -> finish)
- Use `name+` for multi-word arguments
- Use `@flag` for boolean options
- Use `@option` for valued options
- Keep function names simple, use aliases for command names

**Next Steps:**
1. Implement `rm` command (15 min)
2. Add nested display to `list` (30 min)
3. Add format/only options to `list` (20 min)
4. Add helper functions (fuzzy match, logging) (45 min)
5. Then move to porcelain commands

See sub-yaks for specific test debugging if needed.
